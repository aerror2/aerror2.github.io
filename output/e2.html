
<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>使用非托管C++访问WEBSERVICE</title>
    <link rel="stylesheet" href="styles.css">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/themes/prism-okaidia.min.css">

    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">

</head>
<body>
    <div class="header">
        <a href="index.html">← 返回目录</a>
    </div>
    
    <h1>使用非托管C++访问WEBSERVICE</h1>
    <div class="source-link">原文链接: <a href="https://blog.csdn.net/aerror/article/details/2397526" target="_blank">https://blog.csdn.net/aerror/article/details/2397526</a></div>
    
    <div class="article-meta">
        <div class="meta-item"><i class="far fa-calendar-alt"></i> 发布时间: 2008-05-06 03:44:00</div>
        <div class="meta-item"><i class="far fa-eye"></i> 浏览量: 4122</div>
        
        <div class="meta-item"><i class="far fa-star"></i> 收藏数: 1</div>
        
    </div>
    
    <div class="article-tags">标签: <span class="tag">webservice</span>, <span class="tag">c++</span>, <span class="tag">server</span>, <span class="tag">application</span>, <span class="tag">soap</span>, <span class="tag">library</span></div>
    
    <div class="article-description">使用WebServices methods using sproxy.exe provided by Visual Studio 2003 来生成代理. Visual Studio 2005同样带有sproxy.exe 这个工具。但是Visual Studio 2008就没有了. 原因应该是样的:ATL Server: Visual C++ shared source softwareOv</div>
    
    <div class="article-content">
        <div class="htmledit_views atom-one-dark" id="content_views">
<p>使用WebServices methods using sproxy.exe provided by Visual Studio 2003 来生成代理. Visual Studio 2005同样带有sproxy.exe 这个工具。但是Visual Studio 2008就没有了. 原因应该是样的:</p>
<h3>ATL Server: Visual C++ shared source software</h3>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><strong style="mso-bidi-font-weight: normal"><u><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">Overview
    </span></u></strong></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">
  
    
  </span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">The Visual C++ team is very pleased to announce our plans to release the source code of <a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/vccore/html/vcconAtlServer.asp" rel="nofollow" title="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/vccore/html/vcconAtlServer.asp">ATL Server</a> as a <a href="http://www.microsoft.com/resources/sharedsource/licensingbasics/sharedsourcelicenses.mspx" rel="nofollow" title="http://www.microsoft.com/resources/sharedsource/licensingbasics/sharedsourcelicenses.mspx">shared source</a> project on <a href="http://www.codeplex.com/" rel="nofollow" title="http://www.codeplex.com/">CodePlex</a> in March 2007. With this release you will now have the opportunity to add all the features and functionality you want to ATL Server and you can even share your expertise and code directly with the ATL community. A main reason for releasing ATL Sever as shared source project is that many ATL Server users would like to see the functionality and services provided by ATL Server expanded and the Visual C++ team, while agreeing with the vision, cannot do justice to these requests while also working on a number of other libraries and tools that we ship. So rather than constrain the functionality of ATL Server  to fit within our product development cycle we know that by releasing the source code that the ATL Server community can move it forward at a greater pace. And we also know how much developers will enjoy cutting their teeth on such a large commercial codebase.
  </span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">
  
    
  </span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><strong style="mso-bidi-font-weight: normal"><u><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">In a nutshell
    </span></u></strong></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">
  
    
  </span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB"><a href="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/vccore/html/vcconAtlServer.asp" rel="nofollow" title="http://msdn.microsoft.com/library/default.asp?url=/library/en-us/vccore/html/vcconAtlServer.asp">ATL Server</a> is a library of C++ classes that allow developers to build internet based applications. It provides much of the functionality required to build large scale internet sites, such as SOAP messaging, caching facilities, threading facilities, regular expression processing, management of session-state, performance monitoring, MIME support, integration with IIS and class for interacting with security and cryptographic infrastructure.
  </span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">
  
    
  </span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">ATL Server will be released under the <a href="http://www.microsoft.com/resources/sharedsource/licensingbasics/limitedpermissivelicense.mspx" rel="nofollow" title="http://www.microsoft.com/resources/sharedsource/licensingbasics/limitedpermissivelicense.mspx">Microsoft Limited Permissive License (Ms-LPL)</a>.  </span><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB"><span style="FONT-SIZE: 10pt; FONT-FAMILY: Arial">The basic terms of the license indicate:
   </span></span><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial"></span><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">
</span></p>
<ul style="MARGIN-TOP: 0in" type="disc"><li class="MsoNormal" style="MARGIN: 0in 0in 0pt; mso-list: l0 level1 lfo1; tab-stops: list .5in"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">You can read, edit, and redistribute the source code for either commercial or non-commercial purposes, 
   </span></li><li class="MsoNormal" style="MARGIN: 0in 0in 0pt; mso-list: l0 level1 lfo1; tab-stops: list .5in"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">You are allowed to charge a licensing fee for the modified work</span><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial"> </span><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">
</span></li><li class="MsoNormal" style="MARGIN: 0in 0in 0pt; mso-list: l0 level1 lfo1; tab-stops: list .5in"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">The use of the code is limited to the Windows platform.</span><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial"> </span><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">
</span></li></ul>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"> </p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">
</span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">For full and complete details of the licence, and to see if it meets your requirements, you should refer to the <a href="http://www.microsoft.com/resources/sharedsource/licensingbasics/limitedpermissivelicense.mspx" rel="nofollow" title="http://www.microsoft.com/resources/sharedsource/licensingbasics/limitedpermissivelicense.mspx">Ms-LPL license</a>.
  </span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">
  
    
  </span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><strong style="mso-bidi-font-weight: normal"><u><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">To be more specific
    </span></u></strong></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">
  
    
  </span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">The following parts of ATL Server will part of the shared project:
  </span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">
  
    
  </span></p>
<ul style="MARGIN-TOP: 0in" type="disc"><li class="MsoNormal" style="MARGIN: 0in 0in 0pt; mso-list: l0 level1 lfo2; tab-stops: list .5in"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">Core ATL Server Framework classes in atlisapi.h, atlstencil.h, atlserr.h</span><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial"> </span><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">
</span></li><li class="MsoNormal" style="MARGIN: 0in 0in 0pt; mso-list: l0 level1 lfo2; tab-stops: list .5in"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">Caching classes in atlcache.h</span><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial"> </span><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">
</span></li><li class="MsoNormal" style="MARGIN: 0in 0in 0pt; mso-list: l0 level1 lfo2; tab-stops: list .5in"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">Cryptography classes in atlcrypt.h</span><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial"> </span><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">
</span></li><li class="MsoNormal" style="MARGIN: 0in 0in 0pt; mso-list: l0 level1 lfo2; tab-stops: list .5in"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">HTML generation on server side and reading on client sides in atlhtml.h</span><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial"> </span><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">
</span></li><li class="MsoNormal" style="MARGIN: 0in 0in 0pt; mso-list: l0 level1 lfo2; tab-stops: list .5in"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">Performance monitoring classes in atlperf.h</span><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial"> </span><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">
</span></li><li class="MsoNormal" style="MARGIN: 0in 0in 0pt; mso-list: l0 level1 lfo2; tab-stops: list .5in"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">Extension management classes in atlextmgmt.h</span><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial"> </span><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">
</span></li><li class="MsoNormal" style="MARGIN: 0in 0in 0pt; mso-list: l0 level1 lfo2; tab-stops: list .5in"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">Server and client side support for SOAP based Web services in atlsharedsvc.h, atlsoap.h</span><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial"> </span><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">
</span></li><li class="MsoNormal" style="MARGIN: 0in 0in 0pt; mso-list: l0 level1 lfo2; tab-stops: list .5in"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">Session-state classes and interfaces in atlsession.h</span><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial"> </span><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">
</span></li><li class="MsoNormal" style="MARGIN: 0in 0in 0pt; mso-list: l0 level1 lfo2; tab-stops: list .5in"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">MIME/SMTP support in atlmime.h and atlsmtpconnection.h</span><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial"> </span><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">
</span></li><li class="MsoNormal" style="MARGIN: 0in 0in 0pt; mso-list: l0 level1 lfo2; tab-stops: list .5in"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">Regular Expression support from atlrx.h</span><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial"> </span><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">
</span></li><li class="MsoNormal" style="MARGIN: 0in 0in 0pt; mso-list: l0 level1 lfo2; tab-stops: list .5in"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">Stream helpers in atlsoap.h and atlhtml.h</span><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial"> </span><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">
</span></li><li class="MsoNormal" style="MARGIN: 0in 0in 0pt; mso-list: l0 level1 lfo2; tab-stops: list .5in"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">Many of the ATL Server tutorials, samples and help pages.</span><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial"> </span><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">
</span></li></ul>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">
</span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">The following files will be part of the shared source project:
  </span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB"> 
  </span></p>
<table border="0" cellpadding="0" cellspacing="0" class="MsoNormalTable" style="WIDTH: 6.2in; BORDER-COLLAPSE: collapse; mso-padding-alt: 0in 0in 0in 0in" width="595"><tbody><tr style="mso-yfti-irow: 0; mso-yfti-firstrow: yes"><td class="" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: windowtext 1pt solid; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0in; BORDER-LEFT: windowtext 1pt solid; WIDTH: 71.2pt; PADDING-TOP: 0in; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent" width="95"> <p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">atlcache.h
      </span></p> </td><td class="" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: windowtext 1pt solid; PADDING-LEFT: 5.4pt; BORDER-LEFT-COLOR: #ece9d8; PADDING-BOTTOM: 0in; WIDTH: 107.8pt; PADDING-TOP: 0in; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent" width="144"> <p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">atlcrypt.h
      </span></p> </td><td class="" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: windowtext 1pt solid; PADDING-LEFT: 5.4pt; BORDER-LEFT-COLOR: #ece9d8; PADDING-BOTTOM: 0in; WIDTH: 79.8pt; PADDING-TOP: 0in; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent" width="106"> <p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">atlcrypt.inl
      </span></p> </td><td class="" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: windowtext 1pt solid; PADDING-LEFT: 5.4pt; BORDER-LEFT-COLOR: #ece9d8; PADDING-BOTTOM: 0in; WIDTH: 94.45pt; PADDING-TOP: 0in; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent" width="126"> <p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">atlextmgmt.h
      </span></p> </td><td class="" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; BORDER-TOP: windowtext 1pt solid; PADDING-LEFT: 5.4pt; BORDER-LEFT-COLOR: #ece9d8; PADDING-BOTTOM: 0in; WIDTH: 93.15pt; PADDING-TOP: 0in; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent" width="124"> <p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">atlhtml.h
      </span></p> </td></tr><tr style="mso-yfti-irow: 1"><td class="" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0in; BORDER-LEFT: windowtext 1pt solid; WIDTH: 71.2pt; BORDER-TOP-COLOR: #ece9d8; PADDING-TOP: 0in; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent" width="95"> <p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">atlhttp.h
      </span></p> </td><td class="" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; PADDING-LEFT: 5.4pt; BORDER-LEFT-COLOR: #ece9d8; PADDING-BOTTOM: 0in; WIDTH: 107.8pt; BORDER-TOP-COLOR: #ece9d8; PADDING-TOP: 0in; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent" width="144"> <p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">atlhttp.inl
      </span></p> </td><td class="" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; PADDING-LEFT: 5.4pt; BORDER-LEFT-COLOR: #ece9d8; PADDING-BOTTOM: 0in; WIDTH: 79.8pt; BORDER-TOP-COLOR: #ece9d8; PADDING-TOP: 0in; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent" width="106"> <p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">atlisapi.h
      </span></p> </td><td class="" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; PADDING-LEFT: 5.4pt; BORDER-LEFT-COLOR: #ece9d8; PADDING-BOTTOM: 0in; WIDTH: 94.45pt; BORDER-TOP-COLOR: #ece9d8; PADDING-TOP: 0in; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent" width="126"> <p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">atlmime.h
      </span></p> </td><td class="" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; PADDING-LEFT: 5.4pt; BORDER-LEFT-COLOR: #ece9d8; PADDING-BOTTOM: 0in; WIDTH: 93.15pt; BORDER-TOP-COLOR: #ece9d8; PADDING-TOP: 0in; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent" width="124"> <p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">atlperf.h
      </span></p> </td></tr><tr style="mso-yfti-irow: 2"><td class="" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0in; BORDER-LEFT: windowtext 1pt solid; WIDTH: 71.2pt; BORDER-TOP-COLOR: #ece9d8; PADDING-TOP: 0in; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent" width="95"> <p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">atlperf.inl
      </span></p> </td><td class="" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; PADDING-LEFT: 5.4pt; BORDER-LEFT-COLOR: #ece9d8; PADDING-BOTTOM: 0in; WIDTH: 107.8pt; BORDER-TOP-COLOR: #ece9d8; PADDING-TOP: 0in; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent" width="144"> <p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">atlrx.h
      </span></p> </td><td class="" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; PADDING-LEFT: 5.4pt; BORDER-LEFT-COLOR: #ece9d8; PADDING-BOTTOM: 0in; WIDTH: 79.8pt; BORDER-TOP-COLOR: #ece9d8; PADDING-TOP: 0in; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent" width="106"> <p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">atlsession.h
      </span></p> </td><td class="" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; PADDING-LEFT: 5.4pt; BORDER-LEFT-COLOR: #ece9d8; PADDING-BOTTOM: 0in; WIDTH: 94.45pt; BORDER-TOP-COLOR: #ece9d8; PADDING-TOP: 0in; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent" width="126"> <p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">atlserr.h
      </span></p> </td><td class="" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; PADDING-LEFT: 5.4pt; BORDER-LEFT-COLOR: #ece9d8; PADDING-BOTTOM: 0in; WIDTH: 93.15pt; BORDER-TOP-COLOR: #ece9d8; PADDING-TOP: 0in; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent" width="124"> <p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">atlsharedsvc.h
      </span></p> </td></tr><tr style="mso-yfti-irow: 3"><td class="" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0in; BORDER-LEFT: windowtext 1pt solid; WIDTH: 71.2pt; BORDER-TOP-COLOR: #ece9d8; PADDING-TOP: 0in; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent" width="95"> <p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">atlsiface.h
      </span></p> </td><td class="" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; PADDING-LEFT: 5.4pt; BORDER-LEFT-COLOR: #ece9d8; PADDING-BOTTOM: 0in; WIDTH: 107.8pt; BORDER-TOP-COLOR: #ece9d8; PADDING-TOP: 0in; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent" width="144"> <p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">atlsmtpconnection.h
      </span></p> </td><td class="" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; PADDING-LEFT: 5.4pt; BORDER-LEFT-COLOR: #ece9d8; PADDING-BOTTOM: 0in; WIDTH: 79.8pt; BORDER-TOP-COLOR: #ece9d8; PADDING-TOP: 0in; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent" width="106"> <p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">atlsmtputil.h
      </span></p> </td><td class="" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; PADDING-LEFT: 5.4pt; BORDER-LEFT-COLOR: #ece9d8; PADDING-BOTTOM: 0in; WIDTH: 94.45pt; BORDER-TOP-COLOR: #ece9d8; PADDING-TOP: 0in; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent" width="126"> <p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">atlsoap.h
      </span></p> </td><td class="" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; PADDING-LEFT: 5.4pt; BORDER-LEFT-COLOR: #ece9d8; PADDING-BOTTOM: 0in; WIDTH: 93.15pt; BORDER-TOP-COLOR: #ece9d8; PADDING-TOP: 0in; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent" width="124"> <p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">atlsrv.rc
      </span></p> </td></tr><tr style="mso-yfti-irow: 4; mso-yfti-lastrow: yes"><td class="" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; PADDING-LEFT: 5.4pt; PADDING-BOTTOM: 0in; BORDER-LEFT: windowtext 1pt solid; WIDTH: 71.2pt; BORDER-TOP-COLOR: #ece9d8; PADDING-TOP: 0in; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent" width="95"> <p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">atlsrvres.h
      </span></p> </td><td class="" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; PADDING-LEFT: 5.4pt; BORDER-LEFT-COLOR: #ece9d8; PADDING-BOTTOM: 0in; WIDTH: 107.8pt; BORDER-TOP-COLOR: #ece9d8; PADDING-TOP: 0in; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent" width="144"> <p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">atlstencil.h
      </span></p> </td><td class="" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; PADDING-LEFT: 5.4pt; BORDER-LEFT-COLOR: #ece9d8; PADDING-BOTTOM: 0in; WIDTH: 79.8pt; BORDER-TOP-COLOR: #ece9d8; PADDING-TOP: 0in; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent" width="106"> <p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">res/dllmgr.srf
      </span></p> </td><td class="" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; PADDING-LEFT: 5.4pt; BORDER-LEFT-COLOR: #ece9d8; PADDING-BOTTOM: 0in; WIDTH: 94.45pt; BORDER-TOP-COLOR: #ece9d8; PADDING-TOP: 0in; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent" width="126"> <p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">res/stencilmgr.srf
      </span></p> </td><td class="" style="BORDER-RIGHT: windowtext 1pt solid; PADDING-RIGHT: 5.4pt; PADDING-LEFT: 5.4pt; BORDER-LEFT-COLOR: #ece9d8; PADDING-BOTTOM: 0in; WIDTH: 93.15pt; BORDER-TOP-COLOR: #ece9d8; PADDING-TOP: 0in; BORDER-BOTTOM: windowtext 1pt solid; BACKGROUND-COLOR: transparent" width="124"> <p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">res/threadmgr.srf
      </span></p> </td></tr></tbody></table>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">
  
    
  </span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">Classes from atlenc.h for encoding and decoding of data and other utility functions and classes from atlutil.h are going to stay as part of ATL library and ship together with ATL in future releases of Visual Studio.
  </span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">
  
    
  </span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">The source code to the following tools will also become part of the shared source project:
  </span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">
  
    
  </span><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">The Visual C++ team hopes you will enjoy working on the ATL Server code and looks forward to the evolution of this library under the stewardship of the ATL Server community. If you have any question on this announcement then please do not hesitate to post a comment on the VC blog.</span></p>
<ul style="MARGIN-TOP: 0in" type="disc"><li style="MARGIN: 0in 0in 0pt"><span style="FONT-SIZE: 10pt">clstencil.exe - used in running Request Handler DLLs or SRF Files from the command line</span> </li><li style="MARGIN: 0in 0in 0pt"><span style="FONT-SIZE: 10pt">sproxy.exe - used in generating proxy classes for SOAP based Web Service clients</span> </li><li style="MARGIN: 0in 0in 0pt"><span style="FONT-SIZE: 10pt">vcdeploy.exe - used in deploying ATL Server projects to IIS</span></li></ul>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"> </p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB"></span></p>
<p class="MsoNormal" style="MARGIN: 0in 0in 0pt"><span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">原因二:</span></p>
<span lang="EN-GB" style="FONT-SIZE: 10pt; FONT-FAMILY: Arial; mso-ansi-language: EN-GB">
<div class="title">
  Changes in the Visual C++ 2005 Libraries
  
 </div>
<div id="mainSection">
<div id="mainBody">
<p> </p>
<div class="introduction">
<p>The following sections discuss the updates and breaking changes to the libraries that are shipped with Visual C++.</p>
<p> for Mixed Assemblies</p>
</div>
<div class="MTPS_CollapsibleRegion" id="ctl00_rs1_mainContentContainer_cpe233153">
<div class="MTPS_CollapsibleSection" id="ctl00_rs1_mainContentContainer_cpe233153_c" style="DISPLAY: block; OVERFLOW: visible; WIDTH: auto; HEIGHT: auto">
<div class="MTPS_CollapsibleSection" id="" style="BORDER-RIGHT: medium none; BORDER-TOP: medium none; DISPLAY: block; BORDER-LEFT: medium none; BORDER-BOTTOM: medium none">
<div class="subsection">
<div class="subsection">
<div class="subsection">
<p>Visual C++ 2005 supports the use of the Standard C++ Library and the ATL, MFC, and CRT libraries as mixed assemblies compiled with /clr. These mixed libraries allow you to use all of their existing functions when your code contains a mixture of native code and MSIL-based <a href="http://msdn.microsoft.com/en-us/library/ec7sfckb.aspx" id="ctl00_rs1_mainContentContainer_ctl33" rel="nofollow">__clrcall</a> code. For more information, see <a href="http://msdn.microsoft.com/en-us/library/x0w2664k.aspx" id="ctl00_rs1_mainContentContainer_ctl34" rel="nofollow">Mixed (Native and Managed) Assemblies</a>.</p>
</div>
<h5 class="subHeading">Initialization of Mixed Assemblies</h5>
<div class="subsection">
<p>The library support changes in Visual C++ 2005 resolve the "loader lock" issues that applied to mixed DLLs in Visual C++ .NET and Visual C++ .NET 2003. However, there is still a restriction that your <a href="http://msdn.microsoft.com/en-us/library/ms682583.aspx" id="ctl00_rs1_mainContentContainer_ctl35" rel="nofollow">DllMain</a> code must never access the CLR. For more information, see <a href="http://msdn.microsoft.com/en-us/library/x0w2664k.aspx" id="ctl00_rs1_mainContentContainer_ctl36" rel="nofollow">Mixed (Native and Managed) Assemblies</a>.</p>
</div>
<h5 class="subHeading">Libraries not Supported by Pure Mode Compilation</h5>
<div class="subsection">
<p>In Visual C++ 2005, the ATL and MFC libraries are not supported by pure mode compilation (/clr:pure).</p>
<p> </p>
<p>关于SProxy.exe工具的使用：</p>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
</div>
<h3>Introduction</h3>
<p>Some days ago I faced the problem of calling the Webservices from VC++ 6.0 written in C#. The I searched on Google and found the article by Neil Yao that was very useful. Then I started to find the another way for calling the webservices. I came to know about the SPROXY.EXE. It is a command line tool that generates native C++ client code for accessing an XML Web service based on a WSDL description.</p>
<p> </p>
<h4>Soap Features:</h4>
<p>Soap is a protocol which helps to communicate between the applications. Sending messages through internet. It is language independent, platform independent and is based on XML. Today the better way to communicate between is via Http request. Soap was brought in for this purpose.</p>
<h4>Creating the Application:</h4>
<br/>
<p>First Step: <u><strong>Creating Web Service :</strong></u> Create the virtual directory and in that Create the Asp.net web Service project. Name it as MyWebService . In Implementation file that is MyWebService.asmx.cs file write the below code after the Component Designer Generated Code heading: <code><font size="3"><font color="#990000">[WebMethod] </font><font color="#008000"><span class="code-comment"><em>//</em></span><span class="code-comment"><em> Web method which will be exposed by the webservice. </em></span></font><span class="code-keyword"><font color="#0000ff">public</font></span><font color="#990000"> </font><span class="code-SDKkeyword"><font color="#339999">string</font></span><font color="#990000"> MyFun(</font><span class="code-SDKkeyword"><font color="#339999">String</font></span><font color="#990000"> strMyName) { </font><span class="code-keyword"><font color="#0000ff">return</font></span><font color="#990000"> </font><font color="#800080"><span class="code-string">"</span><span class="code-string">Hello "</span></font><font color="#990000"> + strMyName; } </font></font></code>Now build the WebService. </p>
<p>Second Step: <u><strong>Using SPROXY.EXE</strong></u> Go to the Visual studio 2003 command prompt there you type the following line: <code><font color="#990000" size="3">sproxy/wsdl Webservice_URL</font></code> It will generate one header file which is native code. In this file the namespace name and Class name is same and you can find their signatures there. </p>
<p>Third Step: <u><strong>Creating MFC Application</strong></u> I am using Visual Studio 2003. Create New VC++ project then choose MFC Application after that you will see the MFC Application wizard. Click on Application type and Select dialog based application and Click finish. Now go to Resource view, place one button on it and name it as <strong>Call WebService</strong> and name of button as btnWebService. Double Click on the button you will see the message handler added for the button. You will See the OnbtnWebService() function being added. Now add the file created in Step Second in the Application. You will find the new class been created there. Now on click of <strong>OnbtnWebService()</strong> create the object of class and you can invoke the WebServices Methods. For this you have to include the header file and write the one more statement as: </p>
<p><code><font size="3"><font color="#990000">Using namespace createdby_Sproxy;<code> </code></font></font></code></p>
<p><code><font size="3"><font color="#990000"><code></code></font></font></code> </p>
<p><code><font size="3"><font color="#990000"><code>我举个</code></font></font></code></p>
<font color="#990000" face="Courier New" size="3">&gt;sproxy /wsdl <a href="http://10.0.0.102/WebServicesORama/QuoteService.asmx?wsdl" rel="nofollow">http://10.0.0.102/WebServicesORama/QuoteService.asmx?wsdl</a></font>
</span>
</div>
    </div>
    
    <div class="footer">
        <p>发表时间: 2008-05-06 03:44:00</p>
    </div>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/prism.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/autoloader/prism-autoloader.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/prismjs@1.29.0/plugins/copy-to-clipboard/prism-copy-to-clipboard.min.js"></script>

    <script>
        // 处理代码块，添加语言类和复制功能
        document.addEventListener('DOMContentLoaded', function() {            
            // 为没有指定语言的代码块添加默认语言
            document.querySelectorAll('pre code:not([class*="language-"])').forEach(function(block) {
                block.className = 'hljs language-javascript';
            });
            
            // 确保所有代码块都有hljs类
            document.querySelectorAll('pre code[class*="language-"]:not([class*="hljs"])').forEach(function(block) {
                block.className = 'hljs ' + block.className;
            });
            
            // 为所有代码块添加自定义复制按钮
            document.querySelectorAll('pre').forEach(function(pre) {
                // 创建复制按钮
                var copyButton = document.createElement('button');
                copyButton.className = 'copy-button';
                copyButton.textContent = '复制';
                copyButton.style.position = 'absolute';
                copyButton.style.top = '5px';
                copyButton.style.right = '5px';
                copyButton.style.background = 'rgba(0,0,0,0.3)';
                copyButton.style.color = 'white';
                copyButton.style.border = 'none';
                copyButton.style.borderRadius = '3px';
                copyButton.style.padding = '5px 10px';
                copyButton.style.fontSize = '0.8em';
                copyButton.style.cursor = 'pointer';
                copyButton.style.display = 'none';
                
                // 鼠标悬停时显示按钮
                pre.addEventListener('mouseenter', function() {
                    copyButton.style.display = 'block';
                });
                
                pre.addEventListener('mouseleave', function() {
                    copyButton.style.display = 'none';
                });
                
                // 点击复制按钮时复制代码
                copyButton.addEventListener('click', function() {
                    var code = pre.querySelector('code');
                    var text = code.textContent || code.innerText;
                    
                    // 使用现代的 Clipboard API
                    if (navigator.clipboard && navigator.clipboard.writeText) {
                        navigator.clipboard.writeText(text)
                            .then(function() {
                                copyButton.textContent = '已复制!';
                                setTimeout(function() {
                                    copyButton.textContent = '复制';
                                }, 2000);
                            })
                            .catch(function(err) {
                                console.error('Clipboard API 复制失败:', err);
                                // 如果 Clipboard API 失败，尝试使用传统方法
                                fallbackCopyToClipboard();
                            });
                    } else {
                        // 对于不支持 Clipboard API 的浏览器，使用传统方法
                        fallbackCopyToClipboard();
                    }
                    
                    // 传统复制方法作为后备
                    function fallbackCopyToClipboard() {
                        // 创建临时文本区域
                        var textArea = document.createElement('textarea');
                        textArea.value = text;
                        textArea.style.position = 'fixed';
                        textArea.style.left = '-9999px';
                        textArea.style.top = '0';
                        document.body.appendChild(textArea);
                        textArea.focus();
                        textArea.select();
                        
                        try {
                            var successful = document.execCommand('copy');
                            if (successful) {
                                copyButton.textContent = '已复制!';
                                setTimeout(function() {
                                    copyButton.textContent = '复制';
                                }, 2000);
                            } else {
                                copyButton.textContent = '复制失败';
                            }
                        } catch (err) {
                            copyButton.textContent = '复制失败';
                            console.error('传统复制方法失败:', err);
                        }
                        
                        document.body.removeChild(textArea);
                    }
                });
                
                // 添加按钮到代码块
                pre.style.position = 'relative';
                pre.appendChild(copyButton);
            });
            
            // 确保Prism重新高亮所有代码块
            if (typeof Prism !== 'undefined') {
                Prism.highlightAll();
            }
        });
    </script>
</body>
</html>
